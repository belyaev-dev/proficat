import { Ctx, Wizard, WizardStep, Message, On } from "nestjs-telegraf";
import { WIZARD_SCENE_ID } from "../../app.constants";
import { WizardContext } from "telegraf/typings/scenes";

@Wizard(WIZARD_SCENE_ID)
export class GreeterWizard {
  @WizardStep(1)
  async welcome(@Ctx() ctx: WizardContext): Promise<void> {
    ctx.reply(
      "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ü—Ä–æ—Ñ–∏–∫–æ—Ç! \n\n" +
        "–ü—Ä–æ—Ñ–∏–∫–æ—Ç - –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —É—Å–ø–µ—Ö—É. " +
        "–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏, —á—Ç–æ–±—ã –Ω–∞–ø—Ä–∞–≤–∏—Ç—å –≤–∞—Å –∫ —É—Å–ø–µ—à–Ω–æ–π –∫–∞—Ä—å–µ—Ä–µ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é. " +
        "–†–∞—Å–∫—Ä–æ–π—Ç–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Å –ø–æ–º–æ—â—å—é –ü—Ä–æ—Ñ–∏–∫–æ—Ç.\n\n" +
        "–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ü–∏–∞–ª—å–Ω—É—é —Å–µ—Ç—å –¥–ª—è –≤—Ö–æ–¥–∞:",
      {
        reply_markup: {
          keyboard: [[{ text: "–í–ö–æ–Ω—Ç–∞–∫—Ç–µ" }, { text: "–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏" }]],
          one_time_keyboard: true,
        },
      },
    );
    await ctx.wizard.next();
  }

  @On("text")
  @WizardStep(2)
  async processAccess(
    @Ctx() ctx: WizardContext,
    @Message() msg: { text: string },
  ): Promise<void> {
    ctx.reply(
      `–í—ã –≤—ã–±—Ä–∞–ª–∏:  ${msg.text}.\n\n` +
        "–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –≤—ã–¥–∞—Ç—å –¥–æ—Å—Ç—É–ø –¥–ª—è –ü—Ä–æ—Ñ–∏–∫–æ—Ç:",
      {
        reply_markup: {
          inline_keyboard: [
            [
              {
                text: "–î–∞—Ç—å –¥–æ—Å—Ç—É–ø",
                url: "https://id.vk.com/auth?return_auth_hash=02293c90794210968a&redirect_uri=https%3A%2F%2Fproficat.ru&redirect_uri_hash=73dcebe849f7568e7e&force_hash=&app_id=51816906&response_type=code&code_challenge=&code_challenge_method=&scope=0&state=",
              },
            ],
          ],
        },
      },
    );

    // Introduce a delay of 1 minute before sending the next message
    setTimeout(async () => {
      ctx.reply(
        "–°–ø–∞—Å–∏–±–æ!\n\n" +
          "–ü–æ–¥–æ–∂–¥–∏—Ç–µ –ø–∞—Ä—É –º–∏–Ω—É—Ç - –Ω–∞—à–∏ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø—Ä–æ–≤–æ–¥—è—Ç –∞–Ω–∞–ª–∏–∑ –∏ —Å–æ–∑–¥–∞—é—Ç –ø–ª–∞–Ω –≤–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è.",
      );

      setTimeout(async () => {
        ctx.reply(
          "–ü—Ä–æ—Ñ–∏–∫–æ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª –¥–ª—è –≤–∞—Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç.\n\n" +
            "–í–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã:\n" +
            "üë®‚Äçüî¨ –ò—Å—Ç–æ—Ä–∏—è\n" +
            "üîß –†–µ–º–æ–Ω—Ç\n" +
            "üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞\n" +
            "üèóÔ∏è –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ\n\n" +
            "–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å:\n" +
            "- –°—Ä–µ–¥–Ω–µ–µ –æ–±—â–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (11 –∫–ª–∞—Å—Å–æ–≤)\n" +
            "- –ú–ê–†–•–ò, –î–∏–∑–∞–π–Ω –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π —Å—Ä–µ–¥—ã\n" +
            "- 07.03.03 –ë–∞–∫–∞–ª–∞–≤—Ä–∏–∞—Ç, 5 –ª–µ—Ç —É—á—ë–±—ã\n" +
            "- –¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ\n\n" +
            "–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏:\n" +
            "- –†–µ—Å—Ç–∞–≤—Ä–∞—Ç–æ—Ä\n" +
            "- –ú–∞—Ä–∫—à–µ–π–¥–µ—Ä\n" +
            "- –°–ª–µ—Å–∞—Ä—å –ø–æ —Ä–µ–º–æ–Ω—Ç—É —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω\n" +
            "- –ú–æ–Ω—Ç–∞–∂–Ω–∏–∫ —Å–∞–Ω–∏—Ç–∞—Ä–Ω–æ-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è\n\n" +
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—É—Ç—å –≤ –ü—Ä–æ—Ñ–∏–∫–æ—Ç:",
          {
            reply_markup: {
              keyboard: [
                [{ text: "–£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è—Ö" }],
                [{ text: "–ó–∞–ø–∏—Å—å –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏" }],
                [{ text: "–ù–∞–∑–∞–¥" }],
              ],
              one_time_keyboard: true,
            },
          },
        );
        await ctx.wizard.next();
      }, 30000);
    }, 30000); // 1-minute delay after the user clicks the link
  }

  @On("text")
  @WizardStep(3)
  async proffDescription(
    @Ctx() ctx: WizardContext,
    @Message() msg: { text: string },
  ): Promise<void> {
    if (msg.text === "–£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è—Ö") {
      ctx.reply("–í—ã–±–µ—Ä–∏—Ç–µ, –æ –∫–∞–∫–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ —Ö–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ:", {
        reply_markup: {
          keyboard: [
            [{ text: "–†–µ—Å—Ç–∞–≤—Ä–∞—Ç–æ—Ä" }],
            [{ text: "–ú–∞—Ä–∫—à–µ–π–¥–µ—Ä" }],
            [{ text: "–°–ª–µ—Å–∞—Ä—å –ø–æ —Ä–µ–º–æ–Ω—Ç—É" }],
            [{ text: "–ú–æ–Ω—Ç–∞–∂–Ω–∏–∫ —Å–∞–Ω–∏—Ç–∞—Ä–Ω–æ-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º" }],
          ],
          one_time_keyboard: true,
        },
      });
    }
    await ctx.wizard.next();
  }

  @On("text")
  @WizardStep(4)
  async finalStep(
    @Ctx() ctx: WizardContext,
    @Message() msg: { text: string },
  ): Promise<void> {
    switch (msg.text) {
      case "–†–µ—Å—Ç–∞–≤—Ä–∞—Ç–æ—Ä":
        ctx.reply(
          "–†–µ—Å—Ç–∞–≤—Ä–∞—Ç–æ—Ä\n" +
            "–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ä–∏–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è, —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–º–µ—Ç—ã –∏—Å–∫—É—Å—Å—Ç–≤–∞: –º–µ–±–µ–ª—å, –∫–∞—Ä—Ç–∏–Ω—ã, —Å–∫—É–ª—å–ø—Ç—É—Ä—ã –∏ —Ñ—Ä–µ—Å–∫–∏.\n" +
            "üîç –ò–∑—É—á–∞–µ—Ç –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä–∏–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–∞, –∏—Ö –∏—Å—Ç–æ—Ä–∏—é –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏.\n" +
            "üë®‚Äçüî¨ –°–æ–≤–µ—Ç—É–µ—Ç—Å—è —Å –∏—Å—Ç–æ—Ä–∏–∫–∞–º–∏, —Ö–∏–º–∏–∫–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –ª—É—á—à–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã.\n" +
            "üî® –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ —Ä–µ–º–æ–Ω—Ç–∏—Ä—É–µ—Ç –¥—Ä–µ–≤–Ω–∏–µ –∫–∞–º–µ–Ω–Ω—ã–µ —Å—Ç–µ–Ω—ã, –¥–µ—Ä–µ–≤—è–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –∑–¥–∞–Ω–∏–π.\n" +
            "üé® –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞, —É–∑–æ—Ä—ã –∏ –æ—Ä–Ω–∞–º–µ–Ω—Ç—ã –∏ –≤–æ—Å—Å–æ–∑–¥–∞–µ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∏–¥.\n\n" +
            "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ç–æ—Ä:\n" +
            "–î–æ–ø—É—Å—Ç–∏–º, –≤ –≥–æ—Ä–æ–¥–µ –µ—Å—Ç—å —Å—Ç–∞—Ä–∏–Ω–Ω–æ–µ –∑–¥–∞–Ω–∏–µ. –†–µ—Å—Ç–∞–≤—Ä–∞—Ç–æ—Ä—É –ø–æ—Ä—É—á–∞—é—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∏–¥. –°–Ω–∞—á–∞–ª–∞ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –∏–∑—É—á–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –∑–¥–∞–Ω–∏—è –∏ —Å–æ–±–µ—Ä–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ –µ–≥–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ. –ó–∞—Ç–µ–º –æ–Ω –Ω–∞—á–Ω–µ—Ç —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã. –ï—Å–ª–∏ –∫–∞–∫–∞—è-—Ç–æ —á–∞—Å—Ç—å –∑–¥–∞–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞ –∏–ª–∏ –∏—Å–ø–æ—Ä—á–µ–Ω–∞ –≤—Ä–µ–º–µ–Ω–µ–º, —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ç–æ—Ä –∑–∞–π–º–µ—Ç—Å—è –µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å —É—á–µ—Ç–æ–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏. –û–Ω —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –¥–µ—Ç–∞–ª—è–º–∏, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∑–¥–∞–Ω–∏—è. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å—Ç–∞—Ä–∏–Ω–Ω–æ–µ –∑–¥–∞–Ω–∏–µ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –æ–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ.\n\n" +
            "–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏:\n" +
            "- 07.02.01 - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞\n" +
            "- 54.02.04 - –†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏—è\n" +
            "- 54.01.17 - –†–µ—Å—Ç–∞–≤—Ä–∞—Ç–æ—Ä —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π\n" +
            "- 54.01.19 - –†–µ—Å—Ç–∞–≤—Ä–∞—Ç–æ—Ä –ø–∞–º—è—Ç–Ω–∏–∫–æ–≤ –∫–∞–º–µ–Ω–Ω–æ–≥–æ –∏ –¥–µ—Ä–µ–≤—è–Ω–Ω–æ–≥–æ –∑–æ–¥—á–µ—Å—Ç–≤–∞\n" +
            "- 07.03.01 - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞\n" +
            "- 07.03.02 - –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –Ω–∞—Å–ª–µ–¥–∏—è\n" +
            "- 54.03.04 - –†–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏—è\n" +
            "- 54.05.02 - –ñ–∏–≤–æ–ø–∏—Å—å\n\n" +
            "–ù—É —á—Ç–æ, –Ω—Ä–∞–≤–∏—Ç—Å—è –ø—Ä–æ—Ñ–µ—Å—Å–∏—è?\n" +
            "–û—Ü–µ–Ω–∏ —Ä–∞–±–æ—Ç—É, —á—Ç–æ–±—ã –º—ã —Å–º–æ–≥–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è —Ç–µ–±—è.",
          {
            reply_markup: {
              keyboard: [[{ text: "üëçüèª" }], [{ text: "üëéüèª" }]],
              one_time_keyboard: true,
            },
          },
        );
        break;
      // Add cases for other professions as needed
    }
    await ctx.wizard.next();
  }
}
